(()=>{var f,A,y;(function(e){e[e.NewSet=0]="NewSet",e[e.Revision=1]="Revision"})(f||(f={})),function(e){e[e.Active=0]="Active",e[e.Complete=1]="Complete",e[e.Dropped=2]="Dropped"}(A||(A={})),function(e){e[e.Primary=0]="Primary",e[e.Collaboration=1]="Collaboration"}(y||(y={}));var b,w;(function(e){e[e.CoreAchievements=3]="CoreAchievements",e[e.UnofficialAchievements=5]="UnofficialAchievements"})(b||(b={})),function(e){e.Primary="0",e.Collaboration="1"}(w||(w={}));var m=e=>{if(!e.username||!e.webApiKey)throw new Error(`
      buildAuthorization() requires an object containing a
      username and webApiKey. eg:

      const authorization = buildAuthorization({
        username: "myUserName",
        webApiKey: "myWebApiKey"
      })
    `);return e};var I=e=>new Promise(t=>setTimeout(()=>t(),e));function h(e,...t){let o="";for(let[i,s]of e.entries())o+=s,i in t&&(o+=t[i]);return o}var P=new URL(window.location).searchParams;if(P.has("data")){let e=JSON.parse(window.atob(P.get("data")));document.getElementById("username").value=e.username,document.getElementById("submission").value=e.links}function T(){let e=new Date;document.getElementById("startdate").valueAsDate=new Date(e.getUTCFullYear(),e.getUTCMonth(),1)}T();async function G(){if(localStorage.getItem("auth")){let e=JSON.parse(localStorage.getItem("auth"));return m(e)}else return await x()}function x(){let t=document.getElementById("authModalTemplate").content.cloneNode(!0),o=t.children[0].querySelector("button");return document.body.appendChild(t),new Promise(i=>{o.addEventListener("click",s=>{let r=document.querySelector("div.authModal"),n={username:r.querySelector("input[name='username']").value,webApiKey:r.querySelector("input[name='apikey']").value};r.querySelector("input[name='saveinfo']").checked&&localStorage.setItem("auth",JSON.stringify(n)),document.body.removeChild(r),i(m(n))})})}document.getElementById("verify").addEventListener("click",async()=>{let e=await G(),t=document.getElementById("username"),o=document.getElementById("altUsername"),i=document.getElementById("submission"),s=document.getElementById("startdate");if(s.value==""){s.style.backgroundColor="red",s.addEventListener("focus",()=>s.style.backgroundColor="revert",{once:!0});return}let r=Array.from(i.value.matchAll("https://(?:www.)?retroachievements.org/game/([0-9]+)")).map(([a,c])=>c),n=Array.from(i.value.matchAll("https://(?:www.)?retroachievements.org/achievement/([0-9]+)")).map(([a,c])=>c);p("output"),t.disabled=!0,o.disabled=!0,s.disabled=!0,output.innerHTML=h`<h1>Games</h1><hr />${r.map(a=>h`<div class="game"><div class="icon"></div><a class="title" href="https://retroachievements.org/game/${a}">${a}</a><span class="timestamp"></span><div class="status">?</div></div>`).join("")}<h1>Achievements</h1><hr />${n.map(a=>h`<div class="achievement"><div class="icon"></div><a class="title" href="https://retroachievements.org/achievement/${a}">${a}</a><span class="timestamp"></span><div class="status">?</div></div>`).join("")} `;let l=async(a,c)=>{let C=a.querySelector(".title").textContent,d=await c(e,t.value,C,s.valueAsDate),g=a.querySelector(".status");g.classList.add(...d.status.split(" ")),g.textContent=d.status.includes("success")?d.status.includes("alt")?"A":"\u2713":"X";let v=document.createElement("img");v.src=`https://media.retroachievements.org${d.icon}`,a.querySelector(".icon").appendChild(v),a.querySelector(".title").textContent=d.title,a.querySelector(".timestamp").textContent=d.timestamp},u=1e3;for(let a of output.querySelectorAll(".game"))await l(a,D),await I(u);for(let a of output.querySelectorAll(".achievement"))await l(a,S),await I(u);t.disabled=!1,o.disabled=!1,s.disabled=!1});document.getElementById("clear").addEventListener("click",()=>{document.getElementById("username").value="",document.getElementById("submission").value="",document.getElementById("output").innerHTML="",document.getElementById("username").disabled=!1,document.getElementById("startdate").disabled=!1,p("submission")});document.getElementById("optionResetAuth").addEventListener("click",()=>{localStorage.removeItem("auth")});document.getElementById("optionCheckDate").addEventListener("change",e=>{let t=document.getElementById("startdate");e.target.checked?(t.disabled=!1,T()):(t.disabled=!0,t.valueAsDate=new Date(0))});for(let e of document.querySelectorAll("#tabs > div")){let t=e.dataset.target;e.addEventListener("mousedown",()=>{p(t)})}function p(e){document.getElementById(e).style.display="block";for(let t of document.querySelectorAll(`#content > :not(#${e})`))t.style.display="none";for(let t of document.querySelectorAll("#tabs > div"))t.classList.remove("selected"),t.dataset.target==e&&t.classList.add("selected")}async function D(e,t,o,i){let s=`https://retroachievements.org/API/API_GetGameInfoAndUserProgress.php?${e}&u=${t}&g=${o}&a=1`,r=await fetch(s).then(c=>c.json()),n="failure";switch(r.HighestAwardKind){case"mastered":n="success mastered";break;case"beaten-hardcore":n="success";break;default:break}let l=new Date(r.HighestAwardDate);l<i&&(n="failure");let u=r.HighestAwardDate?l.toLocaleDateString():"",a=document.getElementById("altUsername").value;if(t!=a&&a.length&&n=="failure"){let c=await D(e,a,o,i);if(c.status.includes("success"))return c.status+=" alt",c}return{status:n,title:r.Title,icon:r.ImageIcon,timestamp:u}}async function S(e,t,o,i){let s=await fetch(`https://retroachievements.org/API/API_GetAchievementUnlocks.php?${e}&a=${o}&c=1`).then(u=>u.json()),n=(await fetch(`https://retroachievements.org/API/API_GetGameInfoAndUserProgress.php?${e}&u=${t}&g=${s.Game.ID}&a=0`).then(u=>u.json())).Achievements[s.Achievement.ID],l="DateEarnedHardcore"in n?new Date(n.DateEarnedHardcore):null;return{status:l>i?"success":"failure",title:s.Achievement.Title,icon:`/Badge/${n.BadgeName}.png`,timestamp:l?l.toLocaleDateString():"N/A"}}})();
//# sourceMappingURL=app.js.map
